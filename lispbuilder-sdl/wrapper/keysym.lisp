
(in-package #:lispbuilder-sdl-base) 

(cffi:defcenum SDL-Key
	(:SDLK-UNKNOWN 0)
	(:SDLK-FIRST 0)
	(:SDLK-BACKSPACE 8)
	(:SDLK-TAB 9)
	(:SDLK-CLEAR 12)
	(:SDLK-RETURN 13)
	(:SDLK-PAUSE 19)
	(:SDLK-ESCAPE 27)
	(:SDLK-SPACE 32)
	(:SDLK-EXCLAIM 33)
	(:SDLK-QUOTEDBL 34)
	(:SDLK-HASH 35)
	(:SDLK-DOLLAR 36)
	(:SDLK-AMPERSAND 38)
	(:SDLK-QUOTE 39)
	(:SDLK-LEFTPAREN 40)
	(:SDLK-RIGHTPAREN 41)
	(:SDLK-ASTERISK 42)
	(:SDLK-PLUS 43)
	(:SDLK-COMMA 44)
	(:SDLK-MINUS 45)
	(:SDLK-PERIOD 46)
	(:SDLK-SLASH 47)
	(:SDLK-0 48)
	(:SDLK-1 49)
	(:SDLK-2 50)
	(:SDLK-3 51)
	(:SDLK-4 52)
	(:SDLK-5 53)
	(:SDLK-6 54)
	(:SDLK-7 55)
	(:SDLK-8 56)
	(:SDLK-9 57)
	(:SDLK-COLON 58)
	(:SDLK-SEMICOLON 59)
	(:SDLK-LESS 60)
	(:SDLK-EQUALS 61)
	(:SDLK-GREATER 62)
	(:SDLK-QUESTION 63)
	(:SDLK-AT 64)
	(:SDLK-LEFTBRACKET 91)
	(:SDLK-BACKSLASH 92)
	(:SDLK-RIGHTBRACKET 93)
	(:SDLK-CARET 94)
	(:SDLK-UNDERSCORE 95)
	(:SDLK-BACKQUOTE 96)
	(:SDLK-a 97)
	(:SDLK-b 98)
	(:SDLK-c 99)
	(:SDLK-d 100)
	(:SDLK-e 101)
	(:SDLK-f 102)
	(:SDLK-g 103)
	(:SDLK-h 104)
	(:SDLK-i 105)
	(:SDLK-j 106)
	(:SDLK-k 107)
	(:SDLK-l 108)
	(:SDLK-m 109)
	(:SDLK-n 110)
	(:SDLK-o 111)
	(:SDLK-p 112)
	(:SDLK-q 113)
	(:SDLK-r 114)
	(:SDLK-s 115)
	(:SDLK-t 116)
	(:SDLK-u 117)
	(:SDLK-v 118)
	(:SDLK-w 119)
	(:SDLK-x 120)
	(:SDLK-y 121)
	(:SDLK-z 122)
	(:SDLK-DELETE 127)
	(:SDLK-WORLD-0 160)
	(:SDLK-WORLD-1 161)
	(:SDLK-WORLD-2 162)
	(:SDLK-WORLD-3 163)
	(:SDLK-WORLD-4 164)
	(:SDLK-WORLD-5 165)
	(:SDLK-WORLD-6 166)
	(:SDLK-WORLD-7 167)
	(:SDLK-WORLD-8 168)
	(:SDLK-WORLD-9 169)
	(:SDLK-WORLD-10 170)
	(:SDLK-WORLD-11 171)
	(:SDLK-WORLD-12 172)
	(:SDLK-WORLD-13 173)
	(:SDLK-WORLD-14 174)
	(:SDLK-WORLD-15 175)
	(:SDLK-WORLD-16 176)
	(:SDLK-WORLD-17 177)
	(:SDLK-WORLD-18 178)
	(:SDLK-WORLD-19 179)
	(:SDLK-WORLD-20 180)
	(:SDLK-WORLD-21 181)
	(:SDLK-WORLD-22 182)
	(:SDLK-WORLD-23 183)
	(:SDLK-WORLD-24 184)
	(:SDLK-WORLD-25 185)
	(:SDLK-WORLD-26 186)
	(:SDLK-WORLD-27 187)
	(:SDLK-WORLD-28 188)
	(:SDLK-WORLD-29 189)
	(:SDLK-WORLD-30 190)
	(:SDLK-WORLD-31 191)
	(:SDLK-WORLD-32 192)
	(:SDLK-WORLD-33 193)
	(:SDLK-WORLD-34 194)
	(:SDLK-WORLD-35 195)
	(:SDLK-WORLD-36 196)
	(:SDLK-WORLD-37 197)
	(:SDLK-WORLD-38 198)
	(:SDLK-WORLD-39 199)
	(:SDLK-WORLD-40 200)
	(:SDLK-WORLD-41 201)
	(:SDLK-WORLD-42 202)
	(:SDLK-WORLD-43 203)
	(:SDLK-WORLD-44 204)
	(:SDLK-WORLD-45 205)
	(:SDLK-WORLD-46 206)
	(:SDLK-WORLD-47 207)
	(:SDLK-WORLD-48 208)
	(:SDLK-WORLD-49 209)
	(:SDLK-WORLD-50 210)
	(:SDLK-WORLD-51 211)
	(:SDLK-WORLD-52 212)
	(:SDLK-WORLD-53 213)
	(:SDLK-WORLD-54 214)
	(:SDLK-WORLD-55 215)
	(:SDLK-WORLD-56 216)
	(:SDLK-WORLD-57 217)
	(:SDLK-WORLD-58 218)
	(:SDLK-WORLD-59 219)
	(:SDLK-WORLD-60 220)
	(:SDLK-WORLD-61 221)
	(:SDLK-WORLD-62 222)
	(:SDLK-WORLD-63 223)
	(:SDLK-WORLD-64 224)
	(:SDLK-WORLD-65 225)
	(:SDLK-WORLD-66 226)
	(:SDLK-WORLD-67 227)
	(:SDLK-WORLD-68 228)
	(:SDLK-WORLD-69 229)
	(:SDLK-WORLD-70 230)
	(:SDLK-WORLD-71 231)
	(:SDLK-WORLD-72 232)
	(:SDLK-WORLD-73 233)
	(:SDLK-WORLD-74 234)
	(:SDLK-WORLD-75 235)
	(:SDLK-WORLD-76 236)
	(:SDLK-WORLD-77 237)
	(:SDLK-WORLD-78 238)
	(:SDLK-WORLD-79 239)
	(:SDLK-WORLD-80 240)
	(:SDLK-WORLD-81 241)
	(:SDLK-WORLD-82 242)
	(:SDLK-WORLD-83 243)
	(:SDLK-WORLD-84 244)
	(:SDLK-WORLD-85 245)
	(:SDLK-WORLD-86 246)
	(:SDLK-WORLD-87 247)
	(:SDLK-WORLD-88 248)
	(:SDLK-WORLD-89 249)
	(:SDLK-WORLD-90 250)
	(:SDLK-WORLD-91 251)
	(:SDLK-WORLD-92 252)
	(:SDLK-WORLD-93 253)
	(:SDLK-WORLD-94 254)
	(:SDLK-WORLD-95 255)
	(:SDLK-KP0 256)
	(:SDLK-KP1 257)
	(:SDLK-KP2 258)
	(:SDLK-KP3 259)
	(:SDLK-KP4 260)
	(:SDLK-KP5 261)
	(:SDLK-KP6 262)
	(:SDLK-KP7 263)
	(:SDLK-KP8 264)
	(:SDLK-KP9 265)
	(:SDLK-KP-PERIOD 266)
	(:SDLK-KP-DIVIDE 267)
	(:SDLK-KP-MULTIPLY 268)
	(:SDLK-KP-MINUS 269)
	(:SDLK-KP-PLUS 270)
	(:SDLK-KP-ENTER 271)
	(:SDLK-KP-EQUALS 272)
	(:SDLK-UP 273)
	(:SDLK-DOWN 274)
	(:SDLK-RIGHT 275)
	(:SDLK-LEFT 276)
	(:SDLK-INSERT 277)
	(:SDLK-HOME 278)
	(:SDLK-END 279)
	(:SDLK-PAGEUP 280)
	(:SDLK-PAGEDOWN 281)
	(:SDLK-F1 282)
	(:SDLK-F2 283)
	(:SDLK-F3 284)
	(:SDLK-F4 285)
	(:SDLK-F5 286)
	(:SDLK-F6 287)
	(:SDLK-F7 288)
	(:SDLK-F8 289)
	(:SDLK-F9 290)
	(:SDLK-F10 291)
	(:SDLK-F11 292)
	(:SDLK-F12 293)
	(:SDLK-F13 294)
	(:SDLK-F14 295)
	(:SDLK-F15 296)
	(:SDLK-NUMLOCK 300)
	(:SDLK-CAPSLOCK 301)
	(:SDLK-SCROLLOCK 302)
	(:SDLK-RSHIFT 303)
	(:SDLK-LSHIFT 304)
	(:SDLK-RCTRL 305)
	(:SDLK-LCTRL 306)
	(:SDLK-RALT 307)
	(:SDLK-LALT 308)
	(:SDLK-RMETA 309)
	(:SDLK-LMETA 310)
	(:SDLK-LSUPER 311)
	(:SDLK-RSUPER 312)
	(:SDLK-MODE 313)
	(:SDLK-COMPOSE 314)
	(:SDLK-HELP 315)
	(:SDLK-PRINT 316)
	(:SDLK-SYSREQ 317)
	(:SDLK-BREAK 318)
	(:SDLK-MENU 319)
	(:SDLK-POWER 320)
	(:SDLK-EURO 321)
	(:SDLK-UNDO 322)
	:SDLK-LAST)

(cffi:defcenum SDL-Mod
	(:KMOD-NONE #x0000)
	(:KMOD-LSHIFT #x0001)
	(:KMOD-RSHIFT #x0002)
	(:KMOD-LCTRL #x0040)
	(:KMOD-RCTRL #x0080)
	(:KMOD-LALT #x0100)
	(:KMOD-RALT #x0200)
	(:KMOD-LMETA #x0400)
	(:KMOD-RMETA #x0800)
	(:KMOD-NUM #x1000)
	(:KMOD-CAPS #x2000)
	(:KMOD-MODE #x4000)
	(:KMOD-RESERVED #x8000))

(cffi:defcstruct SDL-key-sym
	(scancode :unsigned-char)
	(sym SDL-Key)
	(mod SDL-Mod)
	(unicode :unsigned-short))

(cl:defconstant SDL-ALL-HOTKEYS #xFFFFFFFF)

(cffi:defcfun ("SDL_EnableUNICODE" SDL-Enable-UNICODE) :int
  (enable :int))

(cl:defconstant SDL-DEFAULT-REPEAT-DELAY 500)

(cl:defconstant SDL-DEFAULT-REPEAT-INTERVAL 30)

(cffi:defcfun ("SDL_EnableKeyRepeat" SDL-Enable-Key-Repeat) :int
  (delay :int)
  (interval :int))

(cffi:defcfun ("SDL_GetKeyRepeat" SDL-Get-Key-Repeat) :void
  (delay :pointer)
  (interval :pointer))

(cffi:defcfun ("SDL_GetKeyState" SDL-Get-Key-State) :pointer
  (numkeys :pointer))

(cffi:defcfun ("SDL_GetModState" SDL-Get-Mod-State) Sdl-Mod)

(cffi:defcfun ("SDL_SetModState" SDL-Set-Mod-State) :void
  (modstate Sdl-Mod))

(cffi:defcfun ("SDL_GetKeyName" SDL-Get-Key-Name) :string
  (key Sdl-Key))

(defconstant KMOD-CTRL	(logior  (cffi:foreign-enum-value 'Sdl-Mod :KMOD-LCTRL)
				 (cffi:foreign-enum-value 'Sdl-Mod :KMOD-RCTRL)))
(defconstant KMOD-SHIFT	(logior  (cffi:foreign-enum-value 'Sdl-Mod :KMOD-LSHIFT)
				 (cffi:foreign-enum-value 'Sdl-Mod :KMOD-RSHIFT)))
(defconstant KMOD-ALT	(logior  (cffi:foreign-enum-value 'Sdl-Mod :KMOD-LALT)
				 (cffi:foreign-enum-value 'Sdl-Mod :KMOD-RALT)))
(defconstant KMOD-META	(logior  (cffi:foreign-enum-value 'Sdl-Mod :KMOD-LMETA)
				 (cffi:foreign-enum-value 'Sdl-Mod :KMOD-RMETA)))
